class widgetPdfViewer extends elementorModules.frontend.handlers.Base{getDefaultSettings(){return{selectors:{targetInstance:".eac-pdf-viewer",targetWrapper:".fv-viewer__wrapper",targetTrigger:"a.eac-accessible-link"}}}getDefaultElements(){const e=this.getSettings("selectors");let t={$targetInstance:this.$element.find(e.targetInstance),$targetWrapper:this.$element.find(e.targetWrapper),$targetTrigger:this.$element.find(e.targetTrigger),settings:this.$element.find(e.targetWrapper).data("settings"),fileViewer:eacElementsPath.pdfJs+"viewer.html?file=",urlProxy:eacElementsPath.proxies+"proxy-pdf.php",isSafariBrowser:void 0!==window.safari,dataURI:""};return t.$targetIframe=t.$targetWrapper.find("#iframe-"+t.settings.data_id),t.$targetFancybox=t.$targetWrapper.find("#fancybox-"+t.settings.data_id),t.$targetLoader=t.$targetWrapper.find("#fv-viewer_loader-wheel"),t.targetNonce=t.$targetInstance.find("#pdf_nonce").val(),t.options="#pagemode=none&zoom="+t.settings.data_zoom,t}onInit(){super.onInit(),""!==this.elements.settings.data_url&&(this.elements.dataURI=this.elements.settings.data_url,this.elements.$targetLoader.length>0&&this.elements.$targetLoader.show(),this.callAjaxPdf())}callAjaxPdf(){jQuery.ajax({url:this.elements.urlProxy,type:"GET",data:{url:encodeURIComponent(this.elements.dataURI),id:this.elements.settings.data_id,nonce:this.elements.targetNonce},xhrFields:{responseType:"blob"}}).done((e=>{this.elements.$targetLoader.length>0&&this.elements.$targetLoader.hide();const t=e.type,n=(window.URL||window.webkitURL).createObjectURL(e),s=this.elements.fileViewer+n+this.elements.options;t.startsWith("text/plain")||this.elements.isSafariBrowser?"fancybox"===this.elements.settings.data_display?this.elements.$targetFancybox.attr("data-src",n):this.elements.$targetIframe.attr("src",n):"fancybox"===this.elements.settings.data_display?this.elements.$targetFancybox.attr("data-src",s):this.elements.$targetIframe.attr("src",s),"fancybox"===this.elements.settings.data_display?this.displayPdfOnFancybox():this.displayPdfOnIframe()})).fail(((e,t)=>{alert(t+"::"+e.statusText)}))}displayPdfOnFancybox(){this.elements.$targetFancybox.fancybox({afterShow:(e,t)=>{const n=t.$content;n.attr("aria-modal","true"),n.attr("role","dialog"),this.elements.$targetTrigger.attr("aria-expanded","true"),this.elements.settings.data_toolleft||t.$slide.find("iframe").contents().find("#sidebarToggle").css("display","none"),this.elements.settings.data_toolright||t.$slide.find("iframe").contents().find("#secondaryToolbarToggle").css("display","none"),this.elements.settings.data_download||(t.$slide.find("iframe").contents().find("#download").css("display","none"),t.$slide.find("iframe").contents().find("#secondaryDownload").css("display","none")),this.elements.settings.data_print||(t.$slide.find("iframe").contents().find("#print").css("display","none"),t.$slide.find("iframe").contents().find("#secondaryPrint").css("display","none"))},afterClose:()=>{this.elements.$targetTrigger.attr("aria-expanded","false")}})}displayPdfOnIframe(){setTimeout((()=>{this.elements.settings.data_toolleft||this.elements.$targetIframe.contents().find("#sidebarToggle").css("display","none"),this.elements.settings.data_toolright||this.elements.$targetIframe.contents().find("#secondaryToolbarToggle").css("display","none"),this.elements.settings.data_download||(this.elements.$targetIframe.contents().find("#download").css("display","none"),this.elements.$targetIframe.contents().find("#secondaryDownload").css("display","none")),this.elements.settings.data_print||(this.elements.$targetIframe.contents().find("#print").css("display","none"),this.elements.$targetIframe.contents().find("#secondaryPrint").css("display","none"))}),2e3)}}jQuery(window).on("elementor/frontend/init",(()=>{elementorFrontend.hooks.addAction("frontend/element_ready/eac-addon-pdf-viewer.default",(e=>{elementorFrontend.elementsHandler.addHandler(widgetPdfViewer,{$element:e})}))}));