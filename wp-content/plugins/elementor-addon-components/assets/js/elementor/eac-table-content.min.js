class widgetTableOfContent extends elementorModules.frontend.handlers.Base{getDefaultSettings(){return{selectors:{targetInstance:".eac-table-of-content",toc:"#toctoc",tocHead:"#toctoc-head",tocBody:"#toctoc-body"}}}getDefaultElements(){const e=this.getSettings("selectors");return{$targetInstance:this.$element.find(e.targetInstance),$toc:this.$element.find(e.toc),$tocHead:this.$element.find(e.tocHead),$tocBody:this.$element.find(e.tocBody),$tocHeadToggler:jQuery("<span></span>").attr("role","presentation"),settings:{fontawesome:this.$element.find(e.targetInstance).data("settings").data_fontawesome,target:this.$element.find(e.targetInstance).data("settings").data_target,opened:this.$element.find(e.targetInstance).data("settings").data_opened,headPicto:["▼","▲"],titles:this.$element.find(e.targetInstance).data("settings").data_title,trailer:this.$element.find(e.targetInstance).data("settings").data_trailer,ancreAuto:this.$element.find(e.targetInstance).data("settings").data_anchor,topMargin:this.$element.find(e.targetInstance).data("settings").data_topmargin,ariaLabel:this.$element.find(e.targetInstance).data("settings").data_label,ancreDefault:"toc-heading-anchor",windowWith:window.innerWidth},$linksList:[]}}onInit(){super.onInit(),window.location.hash&&setTimeout((()=>{let e=window.location.hash;window.location.hash="",window.location.hash=e}),500),this.buildAnchorLinks()}bindEvents(){this.elements.$tocHead.on("keydown click",this.onTocHeadClickEvent.bind(this)),this.elements.$toc.on("keydown",this.onTocKeyboardEvent.bind(this)),jQuery(window).on("resize",this.onResizeWindow.bind(this)),jQuery(window).on("orientationchange",this.onOrientationChangeWindow())}buildAnchorLinks(){const e=this.elements.settings.target+" ",t=(e+this.elements.settings.titles.split(",").join(","+e)).split(",").join(",");jQuery(t).each(((e,t)=>{const s=jQuery(t);if(s.hasClass("eac-breadcrumbs-item"))return!0;if(!s.is(":hidden")){const t=this.elements.settings.trailer?"-"+(e+1):"",n=s.prop("tagName").toLowerCase(),i=s.text().trim();let a;a=this.elements.settings.ancreAuto?this.elements.settings.ancreDefault:i.replace(/[\$\*\^’&<>"'`=:\/`\\|_\s+]/g,"-").replace(/[#,;.]/g,"").replace(/-+/g,"-").toLowerCase();const o=a+t;s.attr({id:o}).addClass("toctoc-jump-link"),this.elements.$tocBody.append('<a href="#'+o+'" aria-label="'+this.elements.settings.ariaLabel+i+'"><p class="link link-'+n+'"><i class="'+this.elements.settings.fontawesome+'" aria-hidden="true"></i>'+i+"</p></a>")}})),this.elements.$linksList=this.elements.$tocBody.find("a"),this.elements.$tocHead.append(this.elements.$tocHeadToggler),this.elements.settings.opened?(this.elements.$tocBody.css("display","block"),this.elements.$tocHeadToggler.text(this.elements.settings.headPicto[1])):this.elements.$tocHeadToggler.text(this.elements.settings.headPicto[0]),this.elements.$toc.append(this.elements.$tocHead).append(this.elements.$tocBody)}onTocHeadClickEvent(e){if("keydown"===e.type){const t=e.code||e.key||0;if("Enter"!==t&&"Space"!==t)return}e.preventDefault(),this.elements.settings.opened?this.elements.settings.opened=!1:this.elements.settings.opened=!0,this.elements.settings.opened?(this.elements.$tocHeadToggler.text(this.elements.settings.headPicto[1]),this.elements.$tocHead.attr("aria-expanded","true")):(this.elements.$tocHeadToggler.text(this.elements.settings.headPicto[0]),this.elements.$tocHead.attr("aria-expanded","false")),this.elements.$tocBody.slideToggle(300)}onTocKeyboardEvent(e){const t=document.activeElement,s=e.code||e.key||0;if("Escape"===s)this.elements.$tocHeadToggler.text(this.elements.settings.headPicto[0]),this.elements.$tocHead.attr("aria-expanded","false"),this.elements.$tocBody.slideToggle(300),this.elements.$tocHead.trigger("focus");else if("ArrowDown"===s){let s=t;if(e.preventDefault(),jQuery(s).hasClass("toctoc-head"))s=this.elements.$linksList.get(0);else if(jQuery(s).attr("href")){const e=this.elements.$linksList.index(jQuery(s));s=e===this.elements.$linksList.length-1?this.elements.$linksList.get(0):e+1<this.elements.$linksList.length?this.elements.$linksList.get(e+1):this.elements.$linksList.get(e)}jQuery(s).trigger("focus")}else if("ArrowUp"===s){let s=t;if(e.preventDefault(),jQuery(s).attr("href")){const e=this.elements.$linksList.index(jQuery(s));s=e-1>0?this.elements.$linksList.get(e-1):this.elements.$linksList.get(0)}jQuery(s).trigger("focus")}}onResizeWindow(){this.elements.settings.windowWith!==window.innerWidth&&(this.elements.settings.windowWith=window.innerWidth,this.elements.settings.opened=!1,this.elements.$tocHeadToggler.text(this.elements.settings.headPicto[0]),this.elements.$tocBody.slideUp(300))}onOrientationChangeWindow(){window.dispatchEvent(new Event("resize"))}}jQuery(window).on("elementor/frontend/init",(()=>{elementorFrontend.elementsHandler.attachHandler("eac-addon-toc",widgetTableOfContent)}));