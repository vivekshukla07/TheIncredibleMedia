import EacReadTheFeed from"../modules/eac-ajax-read-feed.js";!function(e,n){"use strict";var a={init:function(){n.hooks.addAction("frontend/element_ready/eac-addon-news-ticker.default",a.widgetNewsTicker)},widgetNewsTicker:function(n){var t=n.find(".eac-news-ticker"),i=t.find(".news-ticker_wrapper"),s=i.find(".news-ticker_wrapper-title"),o=i.find(".news-ticker_wrapper-content div"),r=i.find(".news-ticker_wrapper-control"),c=r.find(".play"),l=r.find(".pause"),p=r.find(".left"),d=r.find(".right"),m=t.find("#news_nonce").val(),f=i.data("settings")||{},k=t.find(".news-ticker_item"),w=[],u=0,y=0;0!==Object.keys(f).length&&(f.data_auto&&(o.removeClass("animationPause").addClass("animationPlay"),c.toggle(1),l.toggle(1)),e.each(k,(function(e,n){w.push(n.innerHTML)})),a.setNewsTickerElements(w[u],f,m,s,o),c.on("keydown click",(function(e){const n=e.code||e.key||0;"keydown"===e.type&&"Enter"!==n&&"Space"!==n||(e.preventDefault(),o.removeClass("animationPause").addClass("animationPlay"),c.css({display:"none","animation-play-state":"paused"}),l.css("display","inline-block"),l.focus(),o.css({"-webkit-animation":"newsTickerHrz "+f.data_speed+"s linear infinite",animation:"newsTickerHrz "+f.data_speed+"s linear infinite"}))})),l.on("keydown click",(function(e){const n=e.code||e.key||0;"keydown"===e.type&&"Enter"!==n&&"Space"!==n||(e.preventDefault(),o.removeClass("animationPlay").addClass("animationPause"),c.css({display:"inline-block","animation-play-state":"running"}),c.focus(),l.css("display","none"))})),c.on("animationend",(function(){c.css("animation-play-state","paused")})),p.on("keydown click",(function(e){const n=e.code||e.key||0;"keydown"===e.type&&"Enter"!==n&&"Space"!==n||(e.preventDefault(),o.removeClass("animationPlay"),c.css({display:"none",display:"inline-block","animation-play-state":"running"}),l.css("display","none"),o.css({"-webkit-animation":"restartNewsTickerHrz",animation:"restartNewsTickerHrz"}),u=u-1<=0?0:u-1,y=0,s.html(""),o.empty(),a.setNewsTickerElements(w[u],f,m,s,o))})),d.on("keydown click",(function(e){const n=e.code||e.key||0;"keydown"===e.type&&"Enter"!==n&&"Space"!==n||(e.preventDefault(),o.removeClass("animationPlay"),c.css({display:"none",display:"inline-block","animation-play-state":"running"}),l.css("display","none"),o.css({"-webkit-animation":"restartNewsTickerHrz",animation:"restartNewsTickerHrz"}),u=u+1>=w.length?0:u+1,y=0,s.html(""),o.empty(),a.setNewsTickerElements(w[u],f,m,s,o))})),o.on("animationiteration",(function(){++y>f.data_loop-1&&(y=0,++u>=w.length&&(u=0),s.html(""),o.empty(),a.setNewsTickerElements(w[u],f,m,s,o))})))},setNewsTickerElements:function(n,a,t,i,s){var o=n.split("::")[0],r=n.split("::")[1],c=null;c=new EacReadTheFeed(r.replace(/\s+/g,""),t,a.data_id),e(document).on("ajaxComplete",(function(n,t,r){if(null!=c&&r.ajaxOptions&&r.ajaxOptions===c.getOptions()){n.stopImmediatePropagation();var l=c.getItems();if(l.headError)return i.text(o),s.append('<p class="news-ticker_content-item"><span>'+l.headError+"</span></p>"),s.css("animation-duration","10s !important"),!1;if(!l.rss)return i.text(o),s.append('<p class="news-ticker_content-item"><span>Nothing to display</span></p>'),s.css("animation-duration","10s !important"),!1;l.profile.headTitle;var p=l.profile.headLink,d=l.rss;s.css("animation-duration",a.data_speed+"s"),i.html("<a href='"+p+"'>"+o+"</a>"),e.each(d,(function(e,n){if(e>=a.data_nombre)return!1;var t=n.title,i=n.lien,o="";a.data_date&&(o=new Date(n.update).toLocaleDateString());var r="left"===a.data_rtl?"<p class='news-ticker_content-item'><span class='date'>"+o+"</span><a href='"+i+"' tabindex='-1'><span class='news'>"+t+"</span></a><span class='separator'><i class='fas fa-ellipsis-v'></i></span></p>":"<p class='news-ticker_content-item'><a href='"+i+"' tabindex='-1'><span class='news'>"+t+"</span></a><span class='date'>"+o+"</span><span class='separator'><i class='fas fa-ellipsis-v'></i></span></p>";"left"===a.data_rtl?s.append(r):s.prepend(r)}))}}))}};e(window).on("elementor/frontend/init",a.init)}(jQuery,window.elementorFrontend);