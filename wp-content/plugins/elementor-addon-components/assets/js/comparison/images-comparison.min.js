!function(t,i,e){var n={controlSpace:18,maxWidth:"auto",width:!1,resize:!0,titles:{before:"",after:""},layout:{container:'<div class="b-diff"></div>',item:'<div class="b-diff__item"></div>',control:'<div class="b-diff__control"><div class="b-diff__line"></div><div class="b-diff__arrow b-diff__arrow_left"></div><div class="b-diff__arrow b-diff__arrow_right"></div></div>',title:'<div class="b-diff__title"></div>'}};e.fn.simpleImageDiff=function(i){e.extend(n,i||{}),this.each((function(){var i,o;i=e(this),(o={current:!1,currentParent:!1,loaded:0,dimensions:!1,currentImageDim:{},controlPosition:0,clipAreaRatio:!1,$clipedImage:!1,$control:!1,init:function(){var r=i.find("img").slice(0,2),a=e("body");n.maxWidth=i.attr("data-maxWidth")>0?i.attr("data-maxWidth"):n.maxWidth,n.resize=i.attr("data-resize")?parseInt(i.attr("data-resize")):n.resize,o.current=e(n.layout.container),o.currentParent=i.closest(".eac-images-comparison"),o.current.on("prebuild",(function(){o.dimensions=o.getImageRealSize(r.first().get(0)),n.width||(n.width=o.current.width()),o.current.insertBefore(i),o.current.css({height:n.width/o.dimensions.width*o.dimensions.height,width:o.dimensions.width})})),o.current.on("loaded",(function(){var c,s,d={};function l(t){o.stopAnimation(o.$control),o.stopAnimation(o.$clipedImage);var i=t.pageY||t.originalEvent.touches[0].pageY,e=t.pageX||t.originalEvent.touches[0].pageX,n=!0,r=0;a.on("mousemove.diff touchmove.diff",(function(t){var a=t.pageX||t.originalEvent.touches[0].pageX,c=t.pageY||t.originalEvent.touches[0].pageY;if(Math.abs(c-i)>Math.abs(a-e)&&r<1)return n=!1,!0;n&&(o.controlPosition=a-s.left,o.clipAreaRatio=o.controlPosition/o.currentImageDim.width,o.move(o.controlPosition),r+=1)}))}d.before=r.first().attr("data-title")||n.titles.before,d.after=r.last().attr("data-title")||n.titles.after,r.each((function(t){var i=e(n.layout.item),r=e(n.layout.title);i.append(e(this)),d.before&&t<1&&(r.addClass("b-diff__title_before"),i.append(r.text(d.after))),d.after&&t>0&&(r.addClass("b-diff__title_after"),i.append(r.text(d.before))),o.current.append(i)})),o.$control=e(n.layout.control),o.$clipedImage=o.current.find(".b-diff__item:last"),o.current.append(o.$control),s=o.current.offset(),o.resizeItems(n.width),c=o.$control.width(),o.controlPosition=o.currentImageDim.width/2-c/2,o.clipAreaRatio=o.controlPosition/o.currentImageDim.width,o.move(o.controlPosition),i.remove(),n.resize&&e(t).resize((function(){o.stopAnimation(o.$control),o.stopAnimation(o.$clipedImage),o.resizeItems(),o.controlPosition=o.clipAreaRatio*o.currentImageDim.width,o.move(o.controlPosition),s=o.current.offset()})),o.current.on("click",(function(t){var i=t.pageX||t.originalEvent.touches[0].pageX;o.controlPosition=i-s.left,o.clipAreaRatio=o.controlPosition/o.currentImageDim.width,o.animateItems(o.controlPosition)})),o.current.on("mousedown.diff",(function(t){if(1==t.which)return l(t),!1})),o.current.on("touchstart.diff",l),a.on("mouseup.diff touchend.diff mouseleave.diff touchleave.diff",(function(){a.off("mousemove.diff touchmove.diff")})),r.on("dragstart",(function(){return!1}))})),r.each((function(){this.complete?(o.loaded+=1,1===o.loaded&&o.current.trigger("prebuild"),o.loaded==r.length&&o.current.trigger("loaded")):e(this).on("load",(function(){o.loaded+=1,1===o.loaded&&o.current.trigger("prebuild"),o.loaded==r.length&&o.current.trigger("loaded")}))}))},getImageRealSize:function(t){return{width:t.naturalWidth,height:t.naturalHeight,ratio:t.naturalWidth/t.naturalHeight}},setClipArea:function(t){o.$clipedImage.css("clip","rect(0, "+t+"px,"+o.currentImageDim.height+"px, 0)")},moveControl:function(t){o.$control.css({left:t})},move:function(t){var i=o.$control.width();t<=0?t=0:t>=o.currentImageDim.width-i&&(t=o.currentImageDim.width-i),o.moveControl(t-n.controlSpace),o.setClipArea(t)},resizeItems:function(t){var i,e;e=t||o.current.width(),o.dimensions.width<=e&&(e=o.dimensions.width),"auto"!=n.maxWidth&&(e=n.maxWidth<e?n.maxWidth:e),i=e/o.dimensions.width,o.currentImageDim.width=i*o.dimensions.width,o.currentImageDim.height=i*o.dimensions.height,o.current.find(".b-diff__item").css({width:o.currentImageDim.width,height:o.currentImageDim.height}),o.current.css("height",o.currentImageDim.height),o.$control.css("height",o.currentImageDim.height)},animateItems:function(t){o.$control.css({"-webkit-transition":"left .3s ease-in-out",transition:"left .3s ease-in-out"}),o.$clipedImage.css({"-webkit-transition":"all .3s ease-in-out",transition:"all .3s ease-in-out"}),o.move(t)},stopAnimation:function(t){t.css({"-webkit-transition":"",transition:""})}}).init()}))}}(window,document,jQuery);